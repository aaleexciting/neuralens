<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neuralens AI Detector</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23A78BFA;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%236366F1;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Cpath fill='url(%23grad)' d='M50,10 C27.9,10 10,27.9 10,50 C10,72.1 27.9,90 50,90 C72.1,90 90,72.1 90,50 C90,27.9 72.1,10 50,10 Z M50,75 C36.2,75 25,63.8 25,50 C25,36.2 36.2,25 50,25 C63.8,25 75,36.2 75,50 C75,63.8 63.8,75 50,75 Z' /%3E%3Ccircle fill='white' cx='50' cy='50' r='15' /%3E%3C/svg%3E">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --glow-color-purple: rgba(147, 51, 234, 0.2);
            --glow-color-red: rgba(248, 113, 113, 0.25);
            --glow-color-yellow: rgba(250, 204, 21, 0.25);
            --glow-color-blue: rgba(96, 165, 250, 0.25);
            --glow-color-green: rgba(74, 222, 128, 0.25);
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #030712; /* bg-gray-950 */
        }

        #interaction-card {
            box-shadow: 0 0 80px var(--glow-color-purple);
            transition: box-shadow 500ms ease-in-out, min-height 500ms ease-in-out;
            min-height: 500px;
        }

        .loader {
            border: 4px solid #4B5563; /* border-gray-600 */
            border-top: 4px solid #6366F1; /* border-indigo-500 */
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        #error-message {
            white-space: pre-wrap;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937;
        }
        ::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
        
        /* Transitions & Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        
        .fade-in-up {
             animation: fadeInUp 0.5s ease-in-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #analysis-result > * {
            opacity: 0;
        }
        
        #analysis-result.visible > * {
            animation: fadeInUp 0.6s ease-out forwards;
        }

        #analysis-result.visible > *:nth-child(1) { animation-delay: 0.1s; }
        #analysis-result.visible > *:nth-child(2) { animation-delay: 0.2s; }
        #analysis-result.visible > *:nth-child(3) { animation-delay: 0.3s; }
        #analysis-result.visible > *:nth-child(4) { animation-delay: 0.4s; }


        .modal-backdrop {
            transition: opacity 150ms ease-in-out;
        }

        button:active, .card-active:active {
            transform: scale(0.98);
            transition: transform 0.1s;
        }
    </style>
</head>
<body class="text-gray-200">

    <div class="min-h-screen flex flex-col items-center p-4 py-12 sm:p-8 selection:bg-purple-500/30">
        <div class="w-full max-w-6xl mx-auto">
            <header class="text-center mb-12 fade-in">
                <h1 class="text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-indigo-500">Neuralens AI Detector</h1>
                <p class="mt-2 text-md sm:text-lg text-gray-400 max-w-md mx-auto">Is your image generated by AI? Let's find out.</p>
            </header>

            <main class="grid grid-cols-1 lg:grid-cols-5 gap-8 xl:gap-12">
                <!-- Left Column: Main interaction -->
                <div class="lg:col-span-3">
                    <div id="interaction-card" class="fade-in-up bg-gray-900/50 backdrop-blur-sm border border-gray-700 rounded-2xl shadow-2xl p-6 md:p-8 transition-all duration-300 flex flex-col justify-center">
                        
                        <!-- Upload Content -->
                        <div id="upload-content">
                            <label for="file-input" id="drop-zone" class="relative block border-2 border-dashed border-gray-600 rounded-xl p-8 text-center cursor-pointer hover:border-indigo-500 hover:bg-gray-800/50 transition-all duration-300">
                                <input type="file" id="file-input" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" accept="image/png, image/jpeg, image/webp">
                                <div class="flex flex-col items-center justify-center text-gray-400 pointer-events-none">
                                    <svg class="w-12 h-12 mb-4 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 16.5V9.75m0 0l-3 3m3-3l3 3M6.75 19.5a4.5 4.5 0 01-1.41-8.775 5.25 5.25 0 0110.233-2.33 3 3 0 013.758 3.848A3.752 3.752 0 0118 19.5H6.75z" />
                                    </svg>
                                    <p class="font-semibold text-gray-300">Drag & drop an image here</p>
                                    <p class="text-sm">or <span class="text-indigo-400 font-medium">click to upload</span></p>
                                     <p class="text-xs mt-2 text-gray-500">PNG, JPG, WEBP supported</p>
                                </div>
                            </label>
                            <div class="flex items-center my-6">
                                <div class="flex-grow border-t border-gray-700"></div>
                                <span class="flex-shrink mx-4 text-gray-500 text-sm font-medium">OR</span>
                                <div class="flex-grow border-t border-gray-700"></div>
                            </div>
                            <div class="flex flex-col sm:flex-row gap-3">
                                <input type="text" id="url-input" placeholder="Paste an image URL" class="flex-grow bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:shadow-[0_0_15px_rgba(99,102,241,0.3)] text-gray-200 placeholder-gray-500 transition-all">
                                <button id="analyze-url-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 shadow-md flex items-center justify-center">
                                    <span id="analyze-url-btn-text">Analyze URL</span>
                                    <svg id="analyze-url-spinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                                </button>
                            </div>
                            <div class="mt-6">
                                <p class="text-sm text-gray-500 mb-3 text-center">Don't have an image? Try an example:</p>
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <div id="sample-ai-card" class="group relative cursor-pointer overflow-hidden rounded-lg border border-gray-700 hover:border-indigo-500 transition-all duration-300 card-active">
                                        <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757014145/adadwd_vbbv7p.jpg" alt="AI Generated Example" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                                        <span class="absolute bottom-3 left-3 text-white font-semibold">AI-Generated Example</span>
                                    </div>
                                    <div id="sample-real-card" class="group relative cursor-pointer overflow-hidden rounded-lg border border-gray-700 hover:border-indigo-500 transition-all duration-300 card-active">
                                       <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757014608/realcoy_eyes2h.jpg" alt="Real Photo Example" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                                       <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                                       <span class="absolute bottom-3 left-3 text-white font-semibold">Real Photo Example</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Results Content -->
                        <div id="results-content" class="hidden">
                            <div id="loader" class="flex flex-col items-center justify-center"><div class="loader"></div><p class="mt-4 text-gray-400 font-medium">Analyzing image...</p></div>
                            <div id="error-message" class="hidden text-center text-red-400 bg-red-900/50 p-4 rounded-lg"></div>
                            <div id="analysis-result" class="">
                                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
                                    <div class="flex items-center justify-center"><img id="preview-image" src="" alt="Analyzed image" class="rounded-lg max-h-64 object-contain shadow-lg"></div>
                                    <div>
                                        <h2 class="text-2xl font-bold text-white mb-4">Analysis Result</h2>
                                        <div><p class="text-4xl sm:text-5xl font-black mb-1" id="result-verdict"></p><p class="text-gray-400 mb-4" id="result-subtext"></p></div>
                                        <div class="w-full bg-gray-700 rounded-full h-4"><div id="probability-bar" class="bg-gradient-to-r from-purple-500 to-indigo-500 h-4 rounded-full transition-all duration-500 ease-out"></div></div>
                                        <p class="text-right text-sm mt-1 font-mono" id="probability-text"></p>
                                    </div>
                                </div>
                                <div id="generator-details" class="mt-8 pt-6 border-t border-gray-700">
                                    <h3 class="text-lg font-bold text-white mb-4">AI Generator Details</h3>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-4">
                                        <div id="diffusion-details"></div>
                                        <div id="gan-details"></div>
                                    </div>
                                </div>
                                <div class="mt-8 flex flex-col sm:flex-row gap-3">
                                    <button id="reset-btn" class="w-full sm:w-auto flex-grow bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-300">Analyze Another</button>
                                    <button id="copy-results-btn" class="w-full sm:w-auto bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-300 flex items-center justify-center gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM5 11a1 1 0 00-1 1v2a1 1 0 001 1h10a1 1 0 001-1v-2a1 1 0 00-1-1H5z" /></svg>
                                        <span id="copy-btn-text">Copy</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: History -->
                <aside id="history-container" class="lg:col-span-2 fade-in-up flex flex-col min-h-[500px] lg:min-h-0" style="animation-delay: 0.2s;">
                    <div class="flex justify-between items-center mb-4 flex-shrink-0">
                        <h3 class="text-xl font-bold text-gray-300">Your Analysis History</h3>
                        <button id="clear-history-btn" class="hidden text-sm text-gray-500 hover:text-red-400 transition-colors flex items-center gap-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>
                            Clear All
                        </button>
                    </div>
                    <div class="relative flex-grow">
                        <div id="history-list" class="absolute inset-0 space-y-3 overflow-y-auto pr-2 hidden"></div>
                        <div id="no-history" class="absolute inset-0 flex flex-col items-center justify-center text-center p-8 border-2 border-dashed border-gray-800 rounded-xl bg-gray-900/30">
                            <svg class="mx-auto h-12 w-12 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <h3 class="mt-4 text-lg font-semibold text-gray-300">No Analyses Yet</h3>
                            <p class="mt-1 text-sm text-gray-500">Your recent analyses will appear here once you upload an image.</p>
                        </div>
                    </div>
                </aside>
            </main>
        </div>

        <section id="use-cases-container" class="mt-24 w-full max-w-5xl mx-auto fade-in-up" style="animation-delay: 0.4s;">
            <div class="text-center mb-12">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-indigo-500 max-w-2xl mx-auto">Detect Manipulation, Deepfakes, Fraud, and More</h2>
                <p class="mt-2 text-md sm:text-lg text-gray-400 max-w-3xl mx-auto">Our technology helps identify a wide range of malicious AI-generated content.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Use Case Cards -->
                <div class="group relative overflow-hidden rounded-xl border border-gray-700 bg-gray-900/50 p-5 shadow-lg transition-all duration-300 hover:border-indigo-500/50 hover:shadow-indigo-500/10">
                    <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757074763/1746954651813_tyvoi9.png" alt="Misinformation" class="w-full h-40 object-cover rounded-lg mb-4 transition-transform duration-300 group-hover:scale-105">
                    <span class="absolute top-3 left-3 bg-gray-900/80 text-white text-xs font-bold px-2 py-1 rounded-full border border-gray-600">MIS- & DISINFORMATION</span>
                    <p class="text-sm text-gray-400 mt-2">Spreading AI-generated misinformation and deepfakes in media.</p>
                </div>
                <div class="group relative overflow-hidden rounded-xl border border-gray-700 bg-gray-900/50 p-5 shadow-lg transition-all duration-300 hover:border-indigo-500/50 hover:shadow-indigo-500/10">
                    <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757074427/fake-profile_r7hlnd.jpg" alt="Fake Profile" class="w-full h-40 object-cover rounded-lg mb-4 transition-transform duration-300 group-hover:scale-105">
                    <span class="absolute top-3 left-3 bg-gray-900/80 text-white text-xs font-bold px-2 py-1 rounded-full border border-gray-600">FAKE PROFILES</span>
                    <p class="text-sm text-gray-400 mt-2">Scamming users with fake profiles on social networks.</p>
                </div>
                <div class="group relative overflow-hidden rounded-xl border border-gray-700 bg-gray-900/50 p-5 shadow-lg transition-all duration-300 hover:border-indigo-500/50 hover:shadow-indigo-500/10">
                    <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757074427/fake-id_ronurf.jpg" alt="Fake ID" class="w-full h-40 object-cover rounded-lg mb-4 transition-transform duration-300 group-hover:scale-105">
                    <span class="absolute top-3 left-3 bg-gray-900/80 text-white text-xs font-bold px-2 py-1 rounded-full border border-gray-600">FAKE IDS</span>
                    <p class="text-sm text-gray-400 mt-2">By-passing KYC checks with fake or spoofed identity documents and selfies.</p>
                </div>
                 <div class="group relative overflow-hidden rounded-xl border border-gray-700 bg-gray-900/50 p-5 shadow-lg transition-all duration-300 hover:border-indigo-500/50 hover:shadow-indigo-500/10">
                    <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757074426/impersonation_jvnpvn.jpg" alt="Impersonation" class="w-full h-40 object-cover rounded-lg mb-4 transition-transform duration-300 group-hover:scale-105">
                    <span class="absolute top-3 left-3 bg-gray-900/80 text-white text-xs font-bold px-2 py-1 rounded-full border border-gray-600">IMPERSONATION</span>
                    <p class="text-sm text-gray-400 mt-2">Misleading viewers by representing someone without their consent.</p>
                </div>
                <div class="group relative overflow-hidden rounded-xl border border-gray-700 bg-gray-900/50 p-5 shadow-lg transition-all duration-300 hover:border-indigo-500/50 hover:shadow-indigo-500/10">
                    <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757074425/fabricated-evidence_zzufes.jpg" alt="Fake Photo Evidence" class="w-full h-40 object-cover rounded-lg mb-4 transition-transform duration-300 group-hover:scale-105">
                    <span class="absolute top-3 left-3 bg-gray-900/80 text-white text-xs font-bold px-2 py-1 rounded-full border border-gray-600">FAKE PHOTO EVIDENCE</span>
                    <p class="text-sm text-gray-400 mt-2">Generating fraudulent accident reports with AI-generated images.</p>
                </div>
                <div class="group relative overflow-hidden rounded-xl border border-gray-700 bg-gray-900/50 p-5 shadow-lg transition-all duration-300 hover:border-indigo-500/50 hover:shadow-indigo-500/10">
                    <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757074426/nudification_oeqjbt.jpg" alt="Nudification" class="w-full h-40 object-cover rounded-lg mb-4 transition-transform duration-300 group-hover:scale-105">
                    <span class="absolute top-3 left-3 bg-gray-900/80 text-white text-xs font-bold px-2 py-1 rounded-full border border-gray-600">NUDIFICATION</span>
                    <p class="text-sm text-gray-400 mt-2">Generating abusive images to harm users through impersonation or nudification.</p>
                </div>
                <div class="group relative overflow-hidden rounded-xl border border-gray-700 bg-gray-900/50 p-5 shadow-lg transition-all duration-300 hover:border-indigo-500/50 hover:shadow-indigo-500/10">
                    <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757074426/fake-news_kh9hhu.jpg" alt="Fake News" class="w-full h-40 object-cover rounded-lg mb-4 transition-transform duration-300 group-hover:scale-105">
                    <span class="absolute top-3 left-3 bg-gray-900/80 text-white text-xs font-bold px-2 py-1 rounded-full border border-gray-600">FAKE NEWS</span>
                    <p class="text-sm text-gray-400 mt-2">Spreading fake news to harm democratic processes.</p>
                </div>
                 <div class="group relative overflow-hidden rounded-xl border border-gray-700 bg-gray-900/50 p-5 shadow-lg transition-all duration-300 hover:border-indigo-500/50 hover:shadow-indigo-500/10">
                    <img src="https://res.cloudinary.com/ddrtdofqo/image/upload/v1757074425/fake-insurance-claim_vphh0i.jpg" alt="Insurance Claim" class="w-full h-40 object-cover rounded-lg mb-4 transition-transform duration-300 group-hover:scale-105">
                    <span class="absolute top-3 left-3 bg-gray-900/80 text-white text-xs font-bold px-2 py-1 rounded-full border border-gray-600">INSURANCE CLAIMS</span>
                    <p class="text-sm text-gray-400 mt-2">Creating fake insurance claims with faked images of incidents at home.</p>
                </div>
            </div>
        </section>

        <footer class="w-full max-w-6xl mx-auto py-8 mt-16 border-t border-gray-800 text-gray-400 text-sm fade-in-up" style="animation-delay: 0.6s;">
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 text-center sm:text-left">
                <!-- About Section -->
                <div class="sm:col-span-2 md:col-span-1">
                    <h3 class="font-bold text-lg text-gray-200 mb-3">About Neuralens</h3>
                    <p class="text-sm">
                        Neuralens leverages advanced AI to provide insights into the authenticity of digital images, helping to combat misinformation and build a more transparent digital world.
                    </p>
                </div>
                <!-- Quick Links Section -->
                <div>
                    <h3 class="font-bold text-lg text-gray-200 mb-3">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="legal.html#terms-of-service" class="hover:text-indigo-400 transition-colors">Terms of Service</a></li>
                        <li><a href="legal.html#privacy-policy" class="hover:text-indigo-400 transition-colors">Privacy Policy</a></li>
                        <li><a href="#use-cases-container" class="hover:text-indigo-400 transition-colors">Use Cases</a></li>
                    </ul>
                </div>
                <!-- Contact Section -->
                <div>
                    <h3 class="font-bold text-lg text-gray-200 mb-3">Contact Developer</h3>
                    <p class="mb-3">Ardan Ridho</p>
                    <div class="flex justify-center sm:justify-start gap-x-5">
                        <a href="https://ardhan.my.id" target="_blank" rel="noopener noreferrer" class="hover:text-indigo-400 transition-colors" aria-label="Personal Website">
                           <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 20a10 10 0 1 1 0-20a10 10 0 0 1 0 20zm2-2.25a8 8 0 0 0 4-2.46V9a2 2 0 0 1-2-2V3.07a7.95 7.95 0 0 0-3-1V3a2 2 0 0 1-2 2v1a2 2 0 0 1-2 2v2h3a2 2 0 0 1 2 2v5.75zm-4 0V15a2 2 0 0 1-2-2v-1h-.5A1.5 1.5 0 0 1 4 10.5V8H2.25A8.01 8.01 0 0 0 8 17.75z"/>
                            </svg>
                        </a>
                        <a href="https://www.linkedin.com/in/ardnrd/" class="hover:text-indigo-400 transition-colors" aria-label="LinkedIn">
                             <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" />
                            </svg>
                        </a>
                        <a href="https://www.facebook.com/ardhnrd/" class="hover:text-indigo-400 transition-colors" aria-label="Facebook">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v2.385z" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-gray-800 text-center">
                 <p class="text-xs text-gray-600 mb-2">Session ID: <span id="session-id">loading...</span></p>
                 <p>&copy; <span id="copyright-year"></span> Ardan Ridho. All Rights Reserved.</p>
            </div>
        </footer>
    </div>
    
    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 hidden modal-backdrop bg-black/60 backdrop-blur-sm">
        <div class="bg-gray-800 border border-gray-700 rounded-xl shadow-lg w-full max-w-md p-6">
            <h2 class="text-lg font-bold text-white">Clear History</h2>
            <p class="text-sm text-gray-400 mt-2">Are you sure you want to delete all of your analysis history? This action cannot be undone.</p>
            <div class="mt-6 flex justify-end space-x-4">
                <button id="cancel-clear" class="px-4 py-2 rounded-md text-sm font-medium text-gray-300 bg-gray-700 hover:bg-gray-600 transition-colors">Cancel</button>
                <button id="confirm-clear" class="px-4 py-2 rounded-md text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition-colors">Confirm & Delete</button>
            </div>
        </div>
    </div>
    
    <!-- Cookie Consent Banner -->
    <div id="cookie-banner" class="fixed bottom-0 inset-x-0 z-50 p-4 hidden">
        <div class="max-w-xl mx-auto bg-gray-800/80 backdrop-blur-sm border border-gray-700 rounded-xl shadow-2xl p-4">
            <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                <p class="text-sm text-gray-300 text-center sm:text-left">
                    We use local storage to save your analysis history for a better experience. By using our site, you acknowledge and agree to our policies.
                </p>
                <button id="accept-cookies" class="flex-shrink-0 px-5 py-2 rounded-lg text-sm font-semibold text-white bg-indigo-600 hover:bg-indigo-700 transition-colors">
                    Got it
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, onSnapshot, getDocs, writeBatch } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCTrc0DqQ5nKroOhVUqd8cJAcG_CmB6sFA",
            authDomain: "neuralens-app.firebaseapp.com",
            projectId: "neuralens-app",
            storageBucket: "neuralens-app.firebasestorage.app",
            messagingSenderId: "1028894601629",
            appId: "1:1028894601629:web:dff98249e9ed4600a67f74",
            measurementId: "G-219Y4ZZR9B"
        };
        
        const FAKE_AI_RESULT = {
            mainProb: 0.98,
            imageUrl: 'https://res.cloudinary.com/ddrtdofqo/image/upload/v1757014145/adadwd_vbbv7p.jpg',
            genaiData: {
                diffusion: { midjourney: 0.98, stable_diffusion: 0.85, dall_e: 0.21, other: 0.05 },
                gan: { stylegan: 0.1, other: 0.02 }
            }
        };
        const FAKE_REAL_RESULT = {
            mainProb: 0.02,
            imageUrl: 'https://res.cloudinary.com/ddrtdofqo/image/upload/v1757014608/realcoy_eyes2h.jpg',
            genaiData: null
        };

        const dom = {
            dropZone: document.getElementById('drop-zone'),
            fileInput: document.getElementById('file-input'),
            urlInput: document.getElementById('url-input'),
            analyzeUrlBtn: document.getElementById('analyze-url-btn'),
            analyzeUrlBtnText: document.getElementById('analyze-url-btn-text'),
            analyzeUrlSpinner: document.getElementById('analyze-url-spinner'),
            interactionCard: document.getElementById('interaction-card'),
            uploadContent: document.getElementById('upload-content'),
            resultsContent: document.getElementById('results-content'),
            loader: document.getElementById('loader'),
            errorMessage: document.getElementById('error-message'),
            analysisResult: document.getElementById('analysis-result'),
            previewImage: document.getElementById('preview-image'),
            resultVerdict: document.getElementById('result-verdict'),
            resultSubtext: document.getElementById('result-subtext'),
            probabilityBar: document.getElementById('probability-bar'),
            probabilityText: document.getElementById('probability-text'),
            resetBtn: document.getElementById('reset-btn'),
            copyResultsBtn: document.getElementById('copy-results-btn'),
            copyBtnText: document.getElementById('copy-btn-text'),
            historyList: document.getElementById('history-list'),
            noHistory: document.getElementById('no-history'),
            clearHistoryBtn: document.getElementById('clear-history-btn'),
            confirmationModal: document.getElementById('confirmation-modal'),
            cancelClearBtn: document.getElementById('cancel-clear'),
            confirmClearBtn: document.getElementById('confirm-clear'),
            generatorDetails: document.getElementById('generator-details'),
            diffusionDetails: document.getElementById('diffusion-details'),
            ganDetails: document.getElementById('gan-details'),
            sampleAiCard: document.getElementById('sample-ai-card'),
            sampleRealCard: document.getElementById('sample-real-card'),
            copyrightYear: document.getElementById('copyright-year'),
            cookieBanner: document.getElementById('cookie-banner'),
            acceptCookiesBtn: document.getElementById('accept-cookies'),
        };

        let lastResult = { verdict: '', probability: 0 };

        let app, db, auth, userId;
        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
        } catch (error) {
            console.error("Firebase config is missing or invalid.", error);
            displayError("Application is not configured correctly. Please contact support.");
        }

        // Set persistence to localStorage, which is more robust across browsers with strict privacy settings
        setPersistence(auth, browserLocalPersistence)
            .then(() => {
                // After setting persistence, check the auth state
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        const sessionIdEl = document.getElementById('session-id');
                        if (sessionIdEl) {
                            sessionIdEl.textContent = userId;
                        }
                        listenToHistory();
                    } else {
                        try {
                            // If no user, sign in. The persistence is already set.
                            await signInAnonymously(auth);
                        } catch (error) {
                            console.error("Error during sign-in:", error);
                            displayError("Could not start a session. Please check your connection or browser settings.");
                        }
                    }
                });
            })
            .catch((error) => {
                console.error("Error setting auth persistence:", error);
                displayError("Could not save your session. Your browser's privacy settings (or extensions) might be blocking it, which will prevent history from being saved.");
            });

        function initializeAppUI() {
            dom.copyrightYear.textContent = new Date().getFullYear();
            if (!localStorage.getItem('cookieConsent')) {
                show(dom.cookieBanner);
                dom.cookieBanner.classList.add('fade-in-up');
            }
        }
        
        const show = el => { if(el) el.classList.remove('hidden'); };
        const hide = el => { if(el) el.classList.add('hidden'); };
        
        function showLoader() {
            hide(dom.uploadContent);
            show(dom.resultsContent);
            show(dom.loader);
            hide(dom.errorMessage);
            hide(dom.analysisResult);
            dom.analysisResult.classList.remove('visible');
        }

        function hideLoader() {
            hide(dom.loader);
        }

        function displayError(message) {
            show(dom.resultsContent);
            hideLoader();
            dom.errorMessage.textContent = message;
            show(dom.errorMessage);
            hide(dom.analysisResult);
            dom.analysisResult.classList.remove('visible');
        }

        dom.fileInput.addEventListener('change', (e) => handleFile(e.target.files[0]));
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dom.dropZone.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });
        ['dragenter', 'dragover'].forEach(eventName => dom.dropZone.addEventListener(eventName, () => dom.dropZone.classList.add('border-indigo-500', 'bg-gray-800/50')));
        ['dragleave', 'drop'].forEach(eventName => dom.dropZone.addEventListener(eventName, () => dom.dropZone.classList.remove('border-indigo-500', 'bg-gray-800/50')));
        dom.dropZone.addEventListener('drop', (e) => handleFile(e.dataTransfer.files[0]));
        
        dom.analyzeUrlBtn.addEventListener('click', () => {
            const url = dom.urlInput.value.trim();
            if (isValidUrl(url)) {
                dom.analyzeUrlBtn.disabled = true;
                show(dom.analyzeUrlSpinner);
                hide(dom.analyzeUrlBtnText);
                handleUrl(url);
            } else {
                 hide(dom.uploadContent);
                 displayError("Please enter a valid image URL.");
            }
        });
        
        dom.resetBtn.addEventListener('click', () => {
             hide(dom.resultsContent);
             show(dom.uploadContent);
             dom.urlInput.value = '';
             dom.fileInput.value = '';
             dom.interactionCard.style.boxShadow = `0 0 80px var(--glow-color-purple)`;
        });

        dom.clearHistoryBtn.addEventListener('click', () => show(dom.confirmationModal));
        dom.cancelClearBtn.addEventListener('click', () => hide(dom.confirmationModal));
        dom.confirmClearBtn.addEventListener('click', async () => {
            await clearHistory();
            hide(dom.confirmationModal);
        });

        dom.sampleAiCard.addEventListener('click', () => handleSampleAnalysis(FAKE_AI_RESULT));
        dom.sampleRealCard.addEventListener('click', () => handleSampleAnalysis(FAKE_REAL_RESULT));

        dom.copyResultsBtn.addEventListener('click', () => {
            const textToCopy = `Analysis Result: ${lastResult.verdict} (${Math.round(lastResult.probability * 100)}% confidence)`;
            copyToClipboard(textToCopy);
            dom.copyBtnText.textContent = 'Copied!';
            setTimeout(() => { dom.copyBtnText.textContent = 'Copy'; }, 2000);
        });
        
        dom.acceptCookiesBtn.addEventListener('click', () => {
            localStorage.setItem('cookieConsent', 'true');
            hide(dom.cookieBanner);
        });
        
        function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }

        function handleFile(file) {
            if (!file) return;
            if (!file.type.startsWith('image/')) {
                displayError("Please upload a valid image file (PNG, JPG, WEBP).");
                return;
            }
            showLoader();
            const reader = new FileReader();
            reader.onload = e => {
                analyzeImage(file, null, e.target.result);
            };
            reader.readAsDataURL(file);
        }
        
        function handleUrl(url) {
             showLoader();
             analyzeImage(null, url, url);
        }
        
        function handleSampleAnalysis(fakeResult) {
            showLoader();
            setTimeout(() => {
                displayResults(fakeResult.mainProb, fakeResult.genaiData, fakeResult.imageUrl);
            }, 1500);
        }

        function isValidUrl(string) {
            try { new URL(string); return true; } catch (_) { return false; }
        }

        function resetUrlButton() {
            dom.analyzeUrlBtn.disabled = false;
            hide(dom.analyzeUrlSpinner);
            show(dom.analyzeUrlBtnText);
        }

        function copyToClipboard(text) {
            const ta = document.createElement('textarea');
            ta.value = text;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
        }
        
        async function analyzeImage(file, url, previewUrl) {
            let payload = {};
            let logData = {};

            if (file) {
                try {
                    const imageData = await new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = () => resolve(reader.result);
                        reader.onerror = (error) => reject(error);
                        reader.readAsDataURL(file);
                    });
                    payload = { imageData };
                    logData = { source: 'upload', fileName: file.name, previewUrl: '' };
                    
                    if (imageData.length < 200 * 1024) { 
                        logData.previewUrl = imageData;
                    }
                } catch (error) {
                    displayError('Could not read the selected file.');
                    console.error('FileReader error:', error);
                    return;
                }
            } else if (url) {
                payload = { imageUrl: url };
                logData = { source: 'url', url: url, previewUrl: url };
            } else {
                displayError("No image source provided.");
                return;
            }

            await callNetlifyFunction(payload, previewUrl, logData);
        }

        async function callNetlifyFunction(payload, previewUrl, logData) {
            const functionUrl = '/.netlify/functions/analyze';
            
            dom.previewImage.src = previewUrl;

            try {
                const response = await fetch(functionUrl, {
                    method: 'POST',
                    body: JSON.stringify(payload)
                });
                const data = await response.json();

                if (response.ok && data.status === 'success') {
                     if (data.type && typeof data.type.ai_generated !== 'undefined') {
                        const mainProb = data.type.ai_generated;
                        const genaiData = data.genai;
                        displayResults(mainProb, genaiData, previewUrl);
                        await logAnalysisToFirestore({ ...logData, status: 'success', probability: mainProb });
                    } else {
                        let errorMessageText = "Analysis complete, but no AI detection result was returned.\nThis can happen if the image is too small, unsupported, or contains no faces/objects for analysis.";
                        displayError(errorMessageText);
                        await logAnalysisToFirestore({ ...logData, status: 'failure', error: 'Success but no genai data' });
                    }
                } else {
                    const errorMsg = data.error ? data.error.message : 'An unknown API error occurred.';
                    displayError(`API Error: ${errorMsg}`);
                    await logAnalysisToFirestore({ ...logData, status: 'failure', error: errorMsg });
                }
            } catch (err) {
                displayError('An unexpected error occurred. Please check your network connection.');
                await logAnalysisToFirestore({ ...logData, status: 'failure', error: err.message });
            } finally {
                resetUrlButton();
            }
        }
        
        function displayResults(mainProb, genaiData, imageUrl) {
            hideLoader();
            show(dom.analysisResult);
            dom.analysisResult.classList.add('visible');
            dom.previewImage.src = imageUrl;

            const percentage = Math.round(mainProb * 100);
            dom.probabilityText.textContent = `${percentage}% confidence`;
            dom.probabilityBar.style.width = `${percentage}%`;

            if (mainProb > 0.8) {
                lastResult = { verdict: 'AI Generated', probability: mainProb };
            } else if (mainProb > 0.5) {
                lastResult = { verdict: 'Likely AI', probability: mainProb };
            } else if (mainProb > 0.2) {
                lastResult = { verdict: 'Possibly Human', probability: mainProb };
            } else {
                lastResult = { verdict: 'Likely Human', probability: mainProb };
            }
            
            dom.resultVerdict.textContent = lastResult.verdict;
            const { verdictColor, glowVar } = getVerdictStyles(mainProb);
            dom.resultVerdict.className = `text-4xl sm:text-5xl font-black mb-1 ${verdictColor}`;
            dom.interactionCard.style.boxShadow = `0 0 80px var(${glowVar})`;
            dom.resultSubtext.textContent = getVerdictSubtext(mainProb);

            if (genaiData) {
                show(dom.generatorDetails);
                renderGeneratorDetails('Diffusion', genaiData.diffusion, dom.diffusionDetails);
                renderGeneratorDetails('GAN', genaiData.gan, dom.ganDetails);
            } else {
                hide(dom.generatorDetails);
            }
        }
        
        function getVerdictStyles(prob) {
            if (prob > 0.8) return { verdictColor: "text-red-400", glowVar: '--glow-color-red'};
            if (prob > 0.5) return { verdictColor: "text-yellow-400", glowVar: '--glow-color-yellow'};
            if (prob > 0.2) return { verdictColor: "text-blue-400", glowVar: '--glow-color-blue'};
            return { verdictColor: "text-green-400", glowVar: '--glow-color-green'};
        }
        
        function getVerdictSubtext(prob) {
            if (prob > 0.8) return "Very high probability this image was created by AI.";
            if (prob > 0.5) return "Shows characteristics of AI-generated content.";
            if (prob > 0.2) return "Uncertain, but has some traits of AI involvement.";
            return "Suggests this image was not generated by AI.";
        }

        function renderGeneratorDetails(title, data, container) {
            container.innerHTML = '';
            if (!data || Object.keys(data).length === 0) return;

            const titleEl = document.createElement('h4');
            titleEl.className = "text-base font-semibold text-gray-300 mb-2";
            titleEl.textContent = title;
            container.appendChild(titleEl);

            const detailsList = document.createElement('div');
            detailsList.className = 'space-y-2';
            
            const sortedEntries = Object.entries(data).sort(([, a], [, b]) => b - a);

            for (const [key, value] of sortedEntries) {
                const percentage = Math.round(value * 100);
                if (percentage < 1) continue;
                const name = key.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                
                const itemEl = document.createElement('div');
                itemEl.innerHTML = `
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-sm font-medium text-gray-400">${name}</span>
                        <span class="text-sm font-mono text-gray-300">${percentage}%</span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-1.5">
                        <div class="bg-indigo-500 h-1.5 rounded-full" style="width: ${percentage}%"></div>
                    </div>
                `;
                detailsList.appendChild(itemEl);
            }
            container.appendChild(detailsList);
        }

        async function logAnalysisToFirestore(logData) {
            if (!userId) return;
            try {
                await addDoc(collection(db, `artifacts/neuralens-app/users/${userId}/analysis_history`), { ...logData, timestamp: new Date() });
            } catch (e) { console.error("Error adding document to Firestore: ", e); }
        }

        function listenToHistory() {
            if (!userId) return;
            const q = query(collection(db, `artifacts/neuralens-app/users/${userId}/analysis_history`));
            onSnapshot(q, (snapshot) => {
                const history = [];
                snapshot.forEach((doc) => history.push({ id: doc.id, ...doc.data() }));
                history.sort((a, b) => b.timestamp.toMillis() - a.timestamp.toMillis());
                renderHistory(history);
            });
        }
        
        async function clearHistory() {
            if (!userId) return;
            const historyCollection = collection(db, `artifacts/neuralens-app/users/${userId}/analysis_history`);
            const snapshot = await getDocs(historyCollection);
            const batch = writeBatch(db);
            snapshot.docs.forEach(doc => batch.delete(doc.ref));
            await batch.commit();
        }

        function renderHistory(history) {
            if (history.length === 0) {
                show(dom.noHistory);
                hide(dom.clearHistoryBtn);
                hide(dom.historyList); 
                return;
            }
            show(dom.clearHistoryBtn);
            hide(dom.noHistory);
            show(dom.historyList);
            dom.historyList.innerHTML = '';
            
            history.slice(0, 10).forEach(item => {
                let badgeClass, badgeText;
                if(item.status === 'success') {
                    const prob = item.probability;
                    if (prob > 0.8) { badgeClass = 'bg-red-500/20 text-red-300'; badgeText = 'AI Generated'; }
                    else if (prob > 0.5) { badgeClass = 'bg-yellow-500/20 text-yellow-300'; badgeText = 'Likely AI'; }
                    else if (prob > 0.2) { badgeClass = 'bg-blue-500/20 text-blue-300'; badgeText = 'Possibly Human'; }
                    else { badgeClass = 'bg-green-500/20 text-green-300'; badgeText = 'Likely Human'; }
                } else {
                    badgeClass = 'bg-gray-500/20 text-gray-300';
                    badgeText = 'Failed';
                }

                let name = item.fileName || (item.url ? new URL(item.url).hostname : 'Analysis');
                if (name.length > 25) name = name.substring(0, 22) + '...';
                
                const date = item.timestamp.toDate().toLocaleDateString('en-US', { month: 'short', day: 'numeric' });

                const thumbnailHTML = item.previewUrl
                    ? `<img src="${item.previewUrl}" alt="History thumbnail" class="w-12 h-12 rounded-md object-cover flex-shrink-0 bg-gray-700">`
                    : `<div class="w-12 h-12 rounded-md flex-shrink-0 bg-gray-700 flex items-center justify-center">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                               <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd" />
                           </svg>
                       </div>`;

                const div = document.createElement('div');
                div.className = 'bg-gray-800/50 border border-gray-700 p-3 rounded-lg flex items-center gap-4 fade-in-up';
                div.innerHTML = `
                    ${thumbnailHTML}
                    <div class="flex-grow overflow-hidden">
                        <p class="truncate font-medium text-gray-200" title="${item.fileName || item.url}">${name}</p>
                        <p class="text-xs text-gray-400">${date}</p>
                    </div>
                    <div class="text-right flex-shrink-0">
                        ${item.status === 'success' ? `<p class="font-semibold text-lg text-white">${Math.round(item.probability * 100)}%</p>` : ''}
                        <span class="px-2 py-1 text-xs font-medium rounded-full ${badgeClass}">${badgeText}</span>
                    </div>
                `;
                dom.historyList.appendChild(div);
            });
        }

        document.addEventListener('DOMContentLoaded', initializeAppUI);
    </script>
</body>
</html>
